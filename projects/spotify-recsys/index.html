<!doctype html><html lang=en-us><head><title>Spotify playlist recommendation challenge with NeuMF | Cara Van Uden</title><meta charset=utf-8><meta name=language content="en"><meta name=description content><meta name=keywords content><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><link rel="shortcut icon" type=image/png href=/favicon.ico><link type=text/css rel=stylesheet href=/css/post.min.2cb93c91050d1853bf971cc31e00122edd6e0f405aa1de3b7f8ef67ea3b5a79a.css integrity="sha256-LLk8kQUNGFO/lxzDHgASLt1uD0Baod47f472fqO1p5o="><link type=text/css rel=stylesheet href=/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/caravanuden.com\/projects\/spotify-recsys\/","name":"Spotify playlist recommendation challenge with NeuMF","author":{"@type":"Person","name":""},"description":""}</script></head><body><div class=burger__container><div class=burger aria-controls=navigation aria-label=Menu><div class="burger__meat burger__meat--1"></div><div class="burger__meat burger__meat--2"></div><div class="burger__meat burger__meat--3"></div></div></div><nav class=nav id=navigation><ul class=nav__list><li><a href=https://caravanuden.com>home</a></li><li><a href=https://caravanuden.com/about>about</a></li><li><a class=active href=https://caravanuden.com/projects>projects</a></li><li><a href=https://caravanuden.com/blog>blog</a></li></ul></nav><main><div class=flex-wrapper><div class=post__container><div class=post><header class=post__header><h1 id=post__title>Spotify playlist recommendation challenge with NeuMF</h1><time datetime="2018-05-31 00:00:00 +0000 UTC" class=post__date>May 31 2018</time></header><article class=post__content><p><strong>tl;dr</strong>:
This project takes on playlist recommendation with a neural recommendation system.</p><ul><li><a href=https://github.com/caravanuden/spotify_recsys>Github repo</a></li></ul><h2 id=overview>Overview<a class=anchor href=#overview>#</a></h2><p><img src=/images/spotify_recsys/playlist.png alt="A sample playlist"></p><p>Spotify is an online music streaming service with over 140 million active users and over 30 million tracks. One of its popular features is the ability to create playlists, and the service currently hosts over 2 billion playlists.</p><p>This year&rsquo;s challenge focuses on music recommendation, specifically the challenge of automatic playlist continuation. By suggesting appropriate songs to add to a playlist, a recommender system can increase user engagement by making playlist creation easier, as well as extending listening beyond the end of existing playlists. The goal of the challenge is to develop a system for the task of automatic playlist continuation. Given a set of playlist features, my recommender system should generate a list of recommended tracks that can be added to that playlist to ‘continue’ the playlist.</p><h3 id=dataset>Dataset<a class=anchor href=#dataset>#</a></h3><p>As part of this challenge, Spotify has released the Million Playlist Dataset. The MPD contains a million user-generated playlists that were created during the period of January 2010 through October 2017. Each playlist in the MPD contains a playlist title, the track list (including track metadata such as artist, album, and track duration) editing information (last edit time, number of playlist edits) and other miscellaneous information about the playlist.</p><h3 id=questions-besides-the-obvious-challenge-of-building-an-effective-recommender-system>Questions (besides the obvious challenge of building an effective recommender system!)<a class=anchor href=#questions-besides-the-obvious-challenge-of-building-an-effective-recommender-system>#</a></h3><p>This dataset was collected between January 2010 to October 2017. What were the top tracks, artists, and genres (measured through playlist titles) at this time?</p><p>Are there natural patterns that fall out of clustering existing playlists? For example, are there playlist-level differences between different genre-specific playlists (such as rock, rap, classical) or &ldquo;mood&rdquo; playlists (happy, sad, studying)?</p><p>Are there any differences between collaborative and &ldquo;personal&rdquo; playlists?</p><h3 id=overview-of-neumf-neural-recommendation-system>Overview of NeuMF neural recommendation system<a class=anchor href=#overview-of-neumf-neural-recommendation-system>#</a></h3><ol><li>Build sparse one-hot encoding matrix that maps relationships between users (playlists) and items (tracks).</li><li>Playlist (more generally called u for user) and item (i) vectors are used to create embeddings (low-dimensional) for each playlist and item.</li><li>Generalized Matrix Factorization (GMF) combines the two embeddings using the dot product (this is the classic matrix factorization).</li><li>Multi-layer perceptron (MLP) can also create embeddings for user and items. However, instead of taking a dot product of these to obtain the rating, I can concatenate them to create a feature vector that is passed on to deeper layers.</li><li>NeuMF then combines the predictions from MLP and GMF to obtain the final prediction.</li></ol><h3 id=previous-work>Previous work<a class=anchor href=#previous-work>#</a></h3><p>There are two basic methods of music recommendation- metadata information retrieval and collaborative filtering. Metadata information retrieval uses textual metadata (editorial information) supplied by the creators, such as the title of the song, artist name, and lyrics to find some target songs. Though it is fast and accurate, the drawbacks are obvious. First of all, the user has to know about the editorial information for a particular music item. Secondly, it is also time consuming to maintain the increasing metadata. Moreover, the recommendation results is relatively poor, since it can only recommend music based on editorial metadata and none of the users’ information has been considered.</p><p>Collaborative filtering is able to recommend items via the choice of other similar users. As one of the most successful approaches in recommendation systems, it assumes that if user X and Y rate n items similarly or have similar behavior, they will rate or act on other items similarly. Instead of calculating the similarity between items, a set of ‘nearest neighbor’ users for each user whose past ratings have the strongest correlation are found. Therefore, scores for the unseen items are predicted based on a combination of the scores known from the nearest neighbors.</p><p>For this project, I will use neural collaborative filtering (He et al, 2017), implemented in Keras with a Tensorflow backend, to build my playlist recommendation system. I also plan to do some exploratory analyses, like looking at numbers of unique tracks, artists, albums, etc. I may also do some playlist clustering and PCA, to find interesting patterns in these user-generated playlists. I&rsquo;m also interested in the social aspect of playlist creation- are there any distinguishing features of collaborative playlists?</p><h3 id=major-findings>Major findings<a class=anchor href=#major-findings>#</a></h3><p>I found the top artists, tracks, and most-followed playlists for the data (from the period Jan 2010- Oct 2017). See my exploratory analyses for the complete top-20 lists.</p><p>By using kmeans to cluster playlists by genre, I found that there are not playlist-level features (besides name, of course) that differentiate playlists from different genres. Interestingly, the rock, country, and party genres had the highest f-scores (of 0.13, 0.12, and 0.11, respectively) under my model out of all of the genres.</p><p>After removing multicollinear features, I used cross-validated logistic regression to predict whether a playlist is collaborative or not. I acheived an f-score of 0.747 and an ROC AUC of only 0.558. However, I found that that collaborative playlists have more edits and unique artists, but fewer followers, than personal playlists (significant differences between the classes using a Kruskal-Wallis ANOVA). I like that collaborative playlists have a greater diversity of artists- this means that people bring their own music knowledge to the table when collaborating to build a playlist!</p><p>I built a NeuMF recommender system, but due to time and resource constraints could only train it on 1/100th of the data. My model achieves an accuracy of 0.97 after 5 epochs and is able to recommend songs, but in practice they&rsquo;re not the most accurate (how about some Latin dance music for your rock playlist?).</p><h3 id=future-work>Future work<a class=anchor href=#future-work>#</a></h3><p>In the future, I would train my NeuMF model on the complete Spotify MPD. Also, I would attempt to extract playlist embeddings (under my model) for new playlists to implement prediction on the challenge set. I would also be interested at looking at how track-level features differ between playlist genres. This data was also anonymized, so I had <strong>very</strong> limited access to social information (ie, user followers, each user&rsquo;s profile, and other social networks). This would have been very interesting to look into and incorporate into my model (I could boost performance by seeing what music your friends like).</p><h3 id=citations>Citations<a class=anchor href=#citations>#</a></h3><ul><li><a href=https://recsys-challenge.spotify.com/dataset>Spotify MPD</a></li><li><a href=http://webprojects.eecs.qmul.ac.uk/marcusp/papers/SongDixonPearce-CMMR2012.pdf>A general overview of recommendation systems</a></li><li><a href=https://arxiv.org/pdf/1708.05031.pdf>Neural collaborative filtering, He et al 2017</a></li></ul><h3 id=jupyter-notebooks>Jupyter Notebooks<a class=anchor href=#jupyter-notebooks>#</a></h3><ul><li><a href=exploratory_analysis.html>Exploratory analyses</a></li><li><a href=neural_collaborative_filtering.html>NeuMF model for Spotify MPD</a></li></ul><h3 id=slideshttpsdocsgooglecompresentationd19i1oqasg5ndnfr9kdknhgos3pndtika22ynkqwgo0w4editslideidp><a href="https://docs.google.com/presentation/d/19I1OQasg5ndNfR9kdkNhgos3PnDtIkA22yNkqWgO0w4/edit#slide=id.p">Slides</a><a class=anchor href=#slideshttpsdocsgooglecompresentationd19i1oqasg5ndnfr9kdknhgos3pndtika22ynkqwgo0w4editslideidp>#</a></h3></article><ul class=tags__list><li class=tag__item><a class=tag__link href=https://caravanuden.com/tags/recsys/>recsys</a></li><li class=tag__item><a class=tag__link href=https://caravanuden.com/tags/embedding/>embedding</a></li><li class=tag__item><a class=tag__link href=https://caravanuden.com/tags/music/>music</a></li></ul><div class=pagination><a class=pagination__item href=https://caravanuden.com/projects/text-norm/><span class=pagination__label>Next Post</span>
<span class=pagination__title>Google text normalization challenge with LSTM encoder/decoder</a></a></div><footer class=post__footer><div class=social-icons><a class=social-icons__link title=GitHub href=https://github.com/caravanuden target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://caravanuden.com/svg/github.svg)></div></a><a class=social-icons__link title=LinkedIn href=https://www.linkedin.com/in/caravanuden target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://caravanuden.com/svg/linkedin.svg)></div></a><a class=social-icons__link title=Email href=mailto:caravanuden@gmail.com target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://caravanuden.com/svg/email.svg)></div></a></div><p>© 2022</p></footer></div></div><div class=toc-container><nav id=TableOfContents><ul><li><a href=#overview>Overview</a><ul><li><a href=#dataset>Dataset</a></li><li><a href=#questions-besides-the-obvious-challenge-of-building-an-effective-recommender-system>Questions (besides the obvious challenge of building an effective recommender system!)</a></li><li><a href=#overview-of-neumf-neural-recommendation-system>Overview of NeuMF neural recommendation system</a></li><li><a href=#previous-work>Previous work</a></li><li><a href=#major-findings>Major findings</a></li><li><a href=#future-work>Future work</a></li><li><a href=#citations>Citations</a></li><li><a href=#jupyter-notebooks>Jupyter Notebooks</a></li><li><a href=#slideshttpsdocsgooglecompresentationd19i1oqasg5ndnfr9kdknhgos3pndtika22ynkqwgo0w4editslideidp><a href="https://docs.google.com/presentation/d/19I1OQasg5ndNfR9kdkNhgos3PnDtIkA22yNkqWgO0w4/edit#slide=id.p">Slides</a></a></li></ul></li></ul></nav></div></div></main><script src=/js/index.min.49e4d8a384357d9b445b87371863419937ede9fa77737522ffb633073aebfa44.js integrity="sha256-SeTYo4Q1fZtEW4c3GGNBmTft6fp3c3Ui/7YzBzrr+kQ=" crossorigin=anonymous></script><script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script><script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script><script src=/js/table-of-contents.js></script></body></html>